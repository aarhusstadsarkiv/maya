{% extends "base.html" %}

{% macro record_label (label) %}
{% set label = "label_record_" + label %}
<div class="label">
    <strong>{{ translate(label) }}</strong>
</div>
{% endmacro %}

{% macro parse_collectors (key, value) %}
<div class="media-object">
    {{ record_label(key)}}
    <div class="content">
        {% for item in value %}
            <a href="/search?collectors={{ item.id }}">{{ item.label }}</a>
        {% endfor %}
    </div>
</div>
{% endmacro %}

{% macro parse_content_types (key, value) %}
<div class="media-object">
    {{ record_label(key)}}
    <div class="content">
        {% for item in value %}
            <a href="/search?content_types={{ item.id }}">{{ item.label }}</a>
        {% endfor %}
    </div>
</div>
{% endmacro %}

{% macro parse_curators (key, value) %}
<div class="media-object">
    {{ record_label(key)}}
    <div class="content">
        {% for item in value %}
            <a href="/search?curators={{ item.id }}">{{ item.label }}</a>
        {% endfor %}
    </div>
</div>
{% endmacro %}

{% macro parse_creators (key, value) %}
<div class="media-object">
    {{ record_label(key)}}
    <div class="content">
        {% for item in value %}
            <a href="/search?creators={{ item.id }}">{{ item.label }}</a>
        {% endfor %}
    </div>
</div>
{% endmacro %}

{% macro parse_subjects (key, value) %}
<div class="media-object">
    {{ record_label(key)}}
    <div class="content">
        {% for item in value %}
            <a href="/search?subjects={{ item.id }}">{{ item.label }}</a>
        {% endfor %}
    </div>
</div>
{% endmacro %}

{% macro parse_series_normalized (key, value) %}
<div class="media-object">
    {{ record_label(key)}}
    <div class="content">
        {% for item in value %}
            <a href="/search?{{ item.query }}">{{ item.series }}</a>
        {% endfor %}
    </div>
</div>
{% endmacro %}

{% macro parse_collection (key, value) %}
<div class="media-object">
    {{ record_label(key)}}
    <div class="content">
        <a href="/search?collection={{ value.id }}">{{ value.label }}</a>
    </div>
</div>
{% endmacro %}

{% macro parse_organisations (key, value) %}
<div class="media-object">
    {{ record_label(key)}}
    <div class="content">
        {% for item in value %}
            <a href="/search?organisations={{ item.id }}">{{ item.label }}</a>
        {% endfor %}
    </div>
</div>
{% endmacro %}

{% macro parse_locations (key, value) %}
<div class="media-object">
    {{ record_label(key)}}
    <div class="content">
        {% for item in value %}
            <a href="/search?locations={{ item.id }}">{{ item.label }}</a>
        {% endfor %}
    </div>
</div>
{% endmacro %}

{% macro parse_desc_data (key, value) %}
<div class="media-object">
    {% for key, item in value.items() %}
    <div class="label">
        <strong>{{ key }}</strong>
    </div>
    <div class="content">
    {{ item }}
    </div>
    {% endfor %}
</div>
{% endmacro %}

{% macro parse_admin_notes (key, value) %}
<div class="media-object">
    {{ record_label(key)}}
    <div class="content">
        {{ value }}
    </div>
</div>
{% endmacro %}

{% macro parse_contractual_status (key, value) %}
<div class="media-object">
    {{ record_label(key)}}
    <div class="content">
        {{ value.label }}
    </div>
</div>
{% endmacro %}

{% macro parse_label(key, value) %}
<div class="media-object">
    {{ record_label(key)}}
    <div class="content">
        {{ value.label }}
    </div>
</div>
{% endmacro %}

{% macro parse_primitive(key, value) %}
<div class="media-object">
    {{ record_label(key)}}
    <div class="content">
        {{ value }}
    </div>
</div>
{% endmacro %}

{% macro parse_portrait(key, value) %}
<div class="media-object">
    {{ record_label(key)}}
    <div class="image">
        <img src="{{ value }}" alt="{{ key }}" />
    </div>
</div>
{% endmacro %}

{% macro parse_header(key, value) %}
    <h3>{{ value }}</h3>
{% endmacro %}

{% set skip_record_keys = ['series', 'last_updated'] %}

{% macro parse_section(section, values) %}
<div class="{{ section }}">
    {% set header = "header_record_" + section %}
    
    {% if section not in ['abstract'] %}
    <h3 class="record-header">{{ translate(header) }}</h3>
    {% endif %}
    
    {% for key, value in values.items() if not key in skip_record_keys %}
        {% if key == 'collectors' %}
            {{ parse_collectors(key, value) }}
        {% elif key == 'content_types' %}
            {{ parse_content_types(key, value) }}
        {% elif key == 'curators' %}
            {{ parse_curators(key, value) }}
        {% elif key == 'creators' %}
            {{ parse_curators(key, value) }}
        {% elif key == 'collection' %}
            {{ parse_collection(key, value) }}
        {% elif key == 'subjects' %}
            {{ parse_subjects(key, value) }}
        {% elif key == 'series_normalized' %}
            {{ parse_series_normalized(key, value) }}
        {% elif key == 'organisations' %}
            {{ parse_organisations(key, value) }}
        {% elif key == 'desc_data' %}
            {{ parse_desc_data(key, value) }}
        {% elif key == 'admin_data' %}
            {{ parse_desc_data(key, value) }}
        {% elif key == 'admin_notes' %}
            {{ parse_admin_notes(key, value) }}
        {% elif key == 'locations' %}
            {{ parse_locations(key, value)}}
        {% elif key == 'contractual_status' %}
            {{ parse_label(key, value) }}
        {% elif key == 'availability' %}
            {{ parse_label(key, value) }}
        {% elif key == 'copyright_status' %}
            {{ parse_label(key, value) }}
        {% elif key == 'other_legal_restrictions' %}
            {{ parse_label(key, value) }}
        {% elif key == 'usability' %}
            {{ parse_label(key, value)}}
        {% elif key == 'portrait' %}
            {{ parse_portrait(key, value)}}
        {% else %}
            {{ parse_primitive(key, value)}}
        {% endif %}
    {% endfor %}
</div>
{% endmacro %}

{% macro parse_title (title) %}
<div class="header">
    <div class="media-object">
        <div class="title">{{ title }}</div>
    </div>
</div>

{% endmacro %}

{% set skip_section_keys = ['other'] %}

{% macro parse_sections(record_sections) %}
    {% for section, section_dict in record_sections.items() if not key in skip_section_keys %}
        {{ parse_section(section, section_dict) }}        
    {% endfor %}
{% endmacro %}

{% block content %}

{{ parse_title(record_sections["description"]["heading"]) }}
{{ parse_sections(record_sections) }}

<pre>
    {{ record_sections_json }}
</pre>


{% endblock content %}