{% import "macros/common_macros.html" as common_macros %}
{% import "macros/relations_macros.html" as relations %}

{% extends "base.html" %}

{% block body_class %}resources-events{% endblock %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', path='/css/overlay.css') }}?v={{ get_setting('version') }}">
<script type="module">
    import { activateOverlay } from "/static/js/overlay.js";
    activateOverlay();
</script>
{% endblock head %}

{% block content %}

{% include "includes/main_title.html" %}

<p>
    <a href="/search?events={{ meta['id_real'] }}">Vis alle resultater i samlingen</a>
</p>

{% set keys = [
"id", "ext_data_season", "ext_data_stagename", "date_from_premier", "ext_data_playwright", "ext_data_original_id",
"ext_data_production", "event_type", "addr_nr", "zipcode", "latitude_longitude", "parish", "rotation", "local_area"] %}

{% set options = {'icon': schema, 'icon_label': 'Lokation'} %}
{{ common_macros.parse_image_block('Stamdata', keys, resource, options) }}

{% set keys = ["ext_data_translater", "ext_data_arkiv_id", "ext_data_number_of_performances"] %}
{{ common_macros.parse_block_common('Beskrivelse', keys, resource) }}

{% set keys = ["sources_normalized"] %}
{{ common_macros.parse_block_common('Kilder', keys, resource) }}

{{ relations.parse_relations('people', resource) }}

{% set meta_links = [
{"url": "/events/" + meta['id_real'] + "/json/api", "label": "JSON. Resource fra API" },
{"url": "/events/" + meta['id_real'] + "/json/resource_and_types", "label": "JSON. Typer og v√¶rdier" }
] %}

{{ common_macros.parse_meta_block(meta_links) }}

<div class="app"></div>

<style>
    .search-suggestions {
        position: absolute;
        background-color: whitesmoke;
        display: none;
        padding: 5px;
        width: 295px;
        max-height: calc(100vh - 150px);
        overflow-y: auto;
    }

    .search-suggestion-item,
    .search-suggestion-info {
        flex: 2;
        padding: 5px;
        border-bottom: 1px solid #ccc;
    }

    .search-suggestion-focus {
        background-color: white;
    }

    .relations-delete {
        cursor: pointer;
        color: red;
        min-width: 25px;
        display: inline-block;
    }
</style>

<script type="module">

    import { init } from  '/static/js/relations-edit.js';

    // Assuming 'relations' variable is already populated with the JSON data
    const resource = {{ to_json(resource) | safe }};
    init(resource.relations, resource.resource_orginal)

</script>


{% endblock content %}